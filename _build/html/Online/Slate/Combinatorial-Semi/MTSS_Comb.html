
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MTSS_Comb &#8212; Causal Decision Making</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Dynamic Assortment Optimization" href="../Assortment%20Optimization.html" />
    <link rel="prev" title="CombLinUCB" href="CombLinUCB.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Causal Decision Making</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
   Causal Decision Making
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Examples.html">
   Motivating Examples
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../Preliminary.html">
   Preliminary
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Preliminary/Causal%20Inference%20101.html">
     Causal Inference 101
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Preliminary/Heterogenous%20Treatement%20Effect.html">
     Heterogenous Treatement Effect
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Preliminary/Policy%20Evaluation%20and%20Optimization.html">
     Policy Evaluation and Optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Map.html">
   Map
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Offline Policy Learner
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../Offline/Single%20Stage.html">
   Single Stage
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Offline/Single/Q-learning_Single.html">
     Q-Learning (Single Stage)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Offline/Single/Policy%20Search.html">
     Policy Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Offline/Single/A-learning_Single.html">
     A-Learning (Single Stage)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Offline/Single/Concordance.html">
     Concordance-assisted learning
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../Offline/Single/Classification.html">
     Reduction to Classification Problems
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../Offline/Single/Classification/O-Learning.html">
       Outcome Weighted Learning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../Offline/Single/Classification/E-learning.html">
       Entropy learning
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../Offline/Single/Continuous.html">
     Continuous Action Space
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../Offline/Single/Continuous/Deep%20Jump%20Learner.html">
       Deep Jump Learner for Continuous Actions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../Offline/Single/Continuous/Kernel-Based%20Learner.html">
       Kernel-Based Learner
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../Offline/Single/Continuous/Outcome%20Learning.html">
       Outcome Learning
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../Offline/Single/Miscellaneous.html">
     Miscellaneous
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../Offline/Single/Miscellaneous/Survival.html">
       Time-to-Event Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../Offline/Single/Miscellaneous/QuantileOTR_test.html">
       <strong>
        Quantile Optimal Treatment Regime
       </strong>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../Offline/Single/Miscellaneous/Adaptively%20Collected%20Data.html">
       Adaptively Collected Data
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../Offline/Multiple%20Stage.html">
   Multiple Stages
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Offline/Multiple/Q-learning_Multiple.html">
     Q-Learning (Multiple Stages)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Offline/Multiple/A-learning_Multiple.html">
     A-Learning (Multiple Stages)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../Offline/Infinite%20Horizon.html">
   Infinite Horizon
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Offline/Infinite/Q-learning_Infinite.html">
     Q-Learning (Infinite Horizon)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../Offline/Infinite/A-learning_Infinite.html">
     A-Learning (Infinite Horizon)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Online Policy Learner
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Single-Item%20Recommendation.html">
   Single-Item Recommendation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Single/Epsilon%20Greedy.html">
     Epsilon Greedy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Single/TS.html">
     TS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Single/LinTS.html">
     LinTS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Single/UCB1.html">
     UCB1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Single/LinUCB.html">
     LinUCB
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../Single/Multi-Task.html">
     Multi-Task
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Single/MultiTask/Meta-TS.html">
       Meta-TS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Single/MultiTask/MTTS.html">
       MTTS
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../Slate%20Recommendation.html">
   Slate Recommendation
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Learning%20to%20rank.html">
     Online Learning to Rank
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Cascade/TS-Cascade.html">
       TS-Cascade
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Cascade/CascadeLinTS.html">
       CascadeLinTS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Cascade/CascadeUCB1.html">
       CascadeUCB1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Cascade/CascadeLinUCB.html">
       CascadeLinUCB
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Cascade/MTSS_Cascade.html">
       MTSS_Cascade
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../Combinatorial%20Optimization.html">
     Online Combinatorial Optimization
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="CombTS.html">
       CombTS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="CombLinTS.html">
       CombLinTS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="CombUCB1.html">
       CombUCB1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="CombLinUCB.html">
       CombLinUCB
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       MTSS_Comb
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Assortment%20Optimization.html">
     Dynamic Assortment Optimization
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../MNL/MNL-Thompson-Beta.html">
       MNL-Thompson-Beta
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../MNL/TS-Contextual-MNL.html">
       TS-Contextual-MNL
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../MNL/UCB-MNL.html">
       UCB_MNL
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../MNL/LUMB.html">
       LUMB
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../MNL/MTSS_MNL.html">
       MTSS_MNL
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Online Policy Evaluation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../OnlineEval/Evaluator.html">
   HAOYU and YE (epsilon+TS+UCB)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Inference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Inference/VariableSelection.html">
   Variable Selection
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/Online/Slate/Combinatorial-Semi/MTSS_Comb.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FOnline/Slate/Combinatorial-Semi/MTSS_Comb.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Online/Slate/Combinatorial-Semi/MTSS_Comb.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main-idea">
   Main Idea
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithm-details">
   Algorithm Details
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#key-steps">
   Key Steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#demo-code">
   Demo Code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#policy-learning">
     1. Policy Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>MTSS_Comb</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main-idea">
   Main Idea
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithm-details">
   Algorithm Details
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#key-steps">
   Key Steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#demo-code">
   Demo Code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#policy-learning">
     1. Policy Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="mtss-comb">
<h1>MTSS_Comb<a class="headerlink" href="#mtss-comb" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="main-idea">
<h2>Main Idea<a class="headerlink" href="#main-idea" title="Permalink to this headline">¬∂</a></h2>
<p>MTSS_Comb is an example of the general Thompson Sampling(TS)-based framework, MTSS [1], to deal with online combinatorial optimization problems.</p>
<p><strong>Review of MTSS:</strong> MTSS[1] is a meta-learning framework designed for large-scale structured bandit problems [2]. Mainly, it is a TS-based algorithm that learns the information-sharing structure while minimizing the cumulative regrets. Adapting the TS framework to a problem-specific Bayesian hierarchical model, MTSS simultaneously enables information sharing among items via their features and models the inter-item heterogeneity. Specifically, it assumes that the item-specific parameter <span class="math notranslate nohighlight">\(\theta_i\)</span> is sampled from a distribution <span class="math notranslate nohighlight">\(g(\theta_i|\boldsymbol{x}_i, \boldsymbol{\gamma})\)</span> instead of being entirely determined by <span class="math notranslate nohighlight">\(\boldsymbol{x}_i\)</span> via a deterministic function. Here, <span class="math notranslate nohighlight">\(g\)</span> is a model parameterized by an <strong>unknown</strong> vector <span class="math notranslate nohighlight">\(\boldsymbol{\gamma}\)</span>. The following is the general feature-based hierarchical model MTSS considered.</p>
<div class="amsmath math notranslate nohighlight" id="equation-f0a25db6-9ff5-4680-9439-37d48d02a284">
<span class="eqno">(37)<a class="headerlink" href="#equation-f0a25db6-9ff5-4680-9439-37d48d02a284" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}\label{eqn:general_hierachical}
  \begin{alignedat}{2}
&amp;\text{(Prior)} \quad
\quad\quad\quad\quad\quad\quad\quad\quad\quad
\boldsymbol{\gamma} &amp;&amp;\sim Q(\boldsymbol{\gamma}),\\
&amp;\text{(Generalization function)} \;
\;    \theta_i| \boldsymbol{x}_i, \boldsymbol{\gamma}  &amp;&amp;\sim g(\theta_i|\boldsymbol{x}_i, \boldsymbol{\gamma}), \forall i \in [N],\\ 
&amp;\text{(Observations)} \quad\quad\quad\quad\quad\quad\;
\;    \boldsymbol{Y}_t &amp;&amp;\sim f(\boldsymbol{Y}_t|A_t, \boldsymbol{\theta}),\\
&amp;\text{(Reward)} \quad\quad\quad\quad\quad\quad\quad\quad\;
\;   R_t &amp;&amp;= f_r(\boldsymbol{Y}_t ; \boldsymbol{\eta}), 
      \end{alignedat}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(Q(\boldsymbol{\gamma})\)</span> is the prior distribution for <span class="math notranslate nohighlight">\(\boldsymbol{\gamma}\)</span>.
Overall, MTTS is a <strong>general</strong> framework that subsumes a wide class of practical problems, <strong>scalable</strong> to large systems, and <strong>robust</strong> to the specification of the generalization model.</p>
<p><strong>Review of MTSS_Comb:</strong> In this tutorial, as an example, we focus on the combinatorial semi-bandits with Gaussian outcome, <span class="math notranslate nohighlight">\(Y_{i, t}\)</span>, and consider using a linear mixed model (LMM) as the generalization model to share information. Specifically, the full model is as follows:</p>
<div class="amsmath math notranslate nohighlight" id="equation-7be2cc6c-4d70-4698-af4c-04d697934384">
<span class="eqno">(38)<a class="headerlink" href="#equation-7be2cc6c-4d70-4698-af4c-04d697934384" title="Permalink to this equation">¬∂</a></span>\[\begin{equation}\label{eqn:LMM}
    \begin{split}
     \theta_i &amp;\sim \mathcal{N}(\boldsymbol{x}_i^T \boldsymbol{\gamma}, \sigma_1^2), \forall i \in [N],\\
    Y_{i, t} &amp;\sim \mathcal{N}(\theta_i, \sigma_2^2), \forall i \in A_{t},\\
    R_t &amp;= \sum_{i \in A_t} Y_{i,t}, 
    \end{split}
\end{equation}\]</div>
<p>where it is typically assumed that <span class="math notranslate nohighlight">\(\sigma_1\)</span> and <span class="math notranslate nohighlight">\(\sigma_2\)</span> are known. We choose the prior <span class="math notranslate nohighlight">\(\boldsymbol{\gamma} \sim \mathcal{N}(\boldsymbol{\mu}_{\boldsymbol{\gamma}}, {\boldsymbol{\Sigma}}_{\boldsymbol{\gamma}})\)</span> with parameters as known. It is worth noting that many other outcome distributions (e.g., Bernoulli) and model assumptions (e.g., Gaussian process) can be formulated similarly, depending on the applications. Users can directly modify the code for posterior updating to adapt different model assumptions. Further, for simplicity, we consider the most basic size constraint such that the action space includes all the possible subsets with size <span class="math notranslate nohighlight">\(K\)</span>. Therefore, the optimization process to find the optimal subset <span class="math notranslate nohighlight">\(A_{t}\)</span> is equal to selecting a list of <span class="math notranslate nohighlight">\(K\)</span> items with the highest attractiveness factors. Of course, users are welcome to modify the <strong>_optimization</strong> function to satisfy more complex constraints.</p>
<p>üí• Application Situation?</p>
</div>
<div class="section" id="algorithm-details">
<h2>Algorithm Details<a class="headerlink" href="#algorithm-details" title="Permalink to this headline">¬∂</a></h2>
<p>Under the assumption of a LMM, the posteriors can be derived explicitly, following the Bayes‚Äô theorem. At each round <span class="math notranslate nohighlight">\(t\)</span>, given the feedback <span class="math notranslate nohighlight">\(\mathcal{H}_{t}\)</span> received from previous rounds, there are two major steps including posterior sampling and combinatorial optimization. Specifically, the posterior sampling step is decomposed into four steps: 1. updating the posterior distribution of <span class="math notranslate nohighlight">\(\boldsymbol{\gamma}\)</span>, <span class="math notranslate nohighlight">\(P(\boldsymbol{\gamma}|\mathcal{H}_{t})\)</span>; 2. sampling a <span class="math notranslate nohighlight">\(\tilde{\boldsymbol{\gamma}}\)</span> from <span class="math notranslate nohighlight">\(P(\boldsymbol{\gamma}|\mathcal{H}_{t})\)</span>; 3. updating the posterior distribution of <span class="math notranslate nohighlight">\(\boldsymbol{\theta}\)</span> conditional on <span class="math notranslate nohighlight">\(\tilde{\boldsymbol{\gamma}}\)</span>, <span class="math notranslate nohighlight">\(P(\boldsymbol{\theta}|\tilde{\boldsymbol{\gamma}},\mathcal{H}_{t})\)</span>; 4. sampling <span class="math notranslate nohighlight">\(\tilde{\boldsymbol{\theta}}\)</span> from <span class="math notranslate nohighlight">\(P(\boldsymbol{\theta}|\tilde{\boldsymbol{\gamma}},\mathcal{H}_{t})\)</span>. Then, the action <span class="math notranslate nohighlight">\(A_{t}\)</span> is selected greedily as <span class="math notranslate nohighlight">\(A_t = arg max_{a \in \mathcal{A}} E(R_t \mid a, \tilde{\boldsymbol{\theta}})\)</span>. Considering the simple size constraint, <span class="math notranslate nohighlight">\(A_{t}\)</span> is the list of <span class="math notranslate nohighlight">\(K\)</span> items with the highest <span class="math notranslate nohighlight">\(\tilde{\theta}_{i}\)</span>. Note that <span class="math notranslate nohighlight">\(\tilde{\boldsymbol{\gamma}}\)</span> can be sampled in a batch mode to further facilitate computationally efficient online deployment.</p>
</div>
<div class="section" id="key-steps">
<h2>Key Steps<a class="headerlink" href="#key-steps" title="Permalink to this headline">¬∂</a></h2>
<p>For round <span class="math notranslate nohighlight">\(t = 1,2,\cdots\)</span>:</p>
<ol class="simple">
<li><p>Update <span class="math notranslate nohighlight">\(P(\boldsymbol{\gamma}|\mathcal{H}_{t})\)</span>;</p></li>
<li><p>Sample <span class="math notranslate nohighlight">\(\tilde{\boldsymbol{\gamma}} \sim P(\boldsymbol{\gamma}|\mathcal{H}_{t})\)</span>;</p></li>
<li><p>Update <span class="math notranslate nohighlight">\(P(\boldsymbol{\theta}|\tilde{\boldsymbol{\gamma}},\mathcal{H}_{t})\)</span>;</p></li>
<li><p>Sample <span class="math notranslate nohighlight">\(\tilde{\boldsymbol{\theta}} \sim P(\boldsymbol{\theta}|\tilde{\boldsymbol{\gamma}},\mathcal{H}_{t})\)</span>;</p></li>
<li><p>Take the action <span class="math notranslate nohighlight">\(A_{t}\)</span> w.r.t <span class="math notranslate nohighlight">\(\tilde{\boldsymbol{\theta}}\)</span> such that <span class="math notranslate nohighlight">\(A_t = arg max_{a \in \mathcal{A}} E(R_t \mid a, \tilde{\boldsymbol{\theta}})\)</span>;</p></li>
<li><p>Receive reward <span class="math notranslate nohighlight">\(R_{t}\)</span>.</p></li>
</ol>
</div>
<div class="section" id="demo-code">
<h2>Demo Code<a class="headerlink" href="#demo-code" title="Permalink to this headline">¬∂</a></h2>
<p>üí• In the following, we exhibit how to apply the learner on real data.</p>
<p>*Notations can be found in either the inroduction of the chapter ‚ÄúSlate Recommendation‚Äù or the introduction of the combinatorial Semi-Bandit problems.</p>
<div class="section" id="policy-learning">
<h3>1. Policy Learning<a class="headerlink" href="#policy-learning" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># After we publish the pack age, we can directly import it</span>
<span class="c1"># TODO: explore more efficient way</span>
<span class="c1"># we can hide this cell later</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;/nas/longleaf/home/lge/CausalDM&#39;</span><span class="p">)</span>
<span class="c1"># code used to import the learner</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span>\<span class="n">ipykernel_423636</span>\<span class="mf">3636065689.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">os</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;/nas/longleaf/home/lge/CausalDM&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="c1"># code used to import the learner</span>

<span class="ne">FileNotFoundError</span>: [WinError 3] Á≥ªÁªüÊâæ‰∏çÂà∞ÊåáÂÆöÁöÑË∑ØÂæÑ„ÄÇ: &#39;/nas/longleaf/home/lge/CausalDM&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">causaldm.learners.Online.Slate.Combinatorial_Semi</span> <span class="kn">import</span> <span class="n">MTSS_Comb</span>
<span class="kn">from</span> <span class="nn">causaldm.learners.Online.Slate.Combinatorial_Semi</span> <span class="kn">import</span> <span class="n">_env_SemiBandit</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">mu_gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">sigma_gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">X_mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">with_intercept</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma_1</span> <span class="o">=</span> <span class="mf">.5</span>
<span class="n">sigma_2</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">_env_SemiBandit</span><span class="o">.</span><span class="n">Semi_env</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sigma_1</span><span class="p">,</span> <span class="n">sigma_2</span>
                               <span class="p">,</span> <span class="n">mu_gamma</span><span class="p">,</span> <span class="n">sigma_gamma</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
                               <span class="p">,</span> <span class="n">with_intercept</span> <span class="o">=</span> <span class="n">with_intercept</span>
                               <span class="p">,</span> <span class="n">X_mu</span> <span class="o">=</span> <span class="n">X_mu</span><span class="p">,</span> <span class="n">X_sigma</span> <span class="o">=</span> <span class="n">X_sigma</span><span class="p">)</span>
<span class="n">MTSS_agent</span> <span class="o">=</span> <span class="n">MTSS_Comb</span><span class="o">.</span><span class="n">MTSS_Semi</span><span class="p">(</span><span class="n">sigma_2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
                                 <span class="p">,</span> <span class="n">gamma_prior_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">gamma_prior_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                                 <span class="p">,</span> <span class="n">sigma_1</span> <span class="o">=</span> <span class="n">sigma_1</span>
                                 <span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">K</span>
                                 <span class="p">,</span> <span class="n">Xs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">Phi</span><span class="c1"># [L, p]</span>
                                 <span class="p">,</span> <span class="n">update_freq</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">MTSS_agent</span><span class="o">.</span><span class="n">take_action</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">Phi</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">obs_R</span><span class="p">,</span> <span class="n">exp_R</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_reward</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">MTSS_agent</span><span class="o">.</span><span class="n">receive_reward</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">obs_R</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">Phi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> A sentence to include the analysis result: the estimated optimal regime is‚Ä¶</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¬∂</a></h2>
<p>[1] Wan, R., Ge, L., &amp; Song, R. (2022). Towards Scalable and Robust Structured Bandits: A Meta-Learning Framework. arXiv preprint arXiv:2202.13227.
[2] Van Parys, B., &amp; Golrezaei, N. (2020). Optimal learning for structured bandits. Available at SSRN 3651397.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Online\Slate\Combinatorial-Semi"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="CombLinUCB.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">CombLinUCB</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Assortment%20Optimization.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dynamic Assortment Optimization</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Causal Decision Making Team<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>