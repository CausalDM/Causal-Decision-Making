Traceback (most recent call last):
  File "D:\anaconda3\lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "D:\anaconda3\lib\site-packages\nbclient\client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "D:\anaconda3\lib\site-packages\nbclient\util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "D:\anaconda3\lib\site-packages\nbclient\util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "D:\anaconda3\lib\asyncio\base_events.py", line 647, in run_until_complete
    return future.result()
  File "D:\anaconda3\lib\site-packages\nbclient\client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "D:\anaconda3\lib\site-packages\nbclient\client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "D:\anaconda3\lib\site-packages\nbclient\client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
problearner_parameters = {"splitter":["best","random"], "max_depth" : range(1,50)},
Direct_est = ME_Single(single_dataset, r_model = 'OLS',
                     problearner_parameters = problearner_parameters,
                     truncate = 50, 
                     target_policy=target_policy, control_policy = control_policy, 
                     dim_state = 2, dim_mediator = 1, 
                     MCMC = 50,
                     nature_decomp = True,
                     seed = 10,
                     method = 'Direct')

Direct_est.estimate_DE_ME()
Direct_est.est_DE, Direct_est.est_ME, Direct_est.est_TE,
------------------

[1;31m---------------------------------------------------------------------------[0m
[1;31mValueError[0m                                Traceback (most recent call last)
Input [1;32mIn [5][0m, in [0;36m<cell line: 2>[1;34m()[0m
[0;32m      1[0m problearner_parameters [38;5;241m=[39m {[38;5;124m"[39m[38;5;124msplitter[39m[38;5;124m"[39m:[[38;5;124m"[39m[38;5;124mbest[39m[38;5;124m"[39m,[38;5;124m"[39m[38;5;124mrandom[39m[38;5;124m"[39m], [38;5;124m"[39m[38;5;124mmax_depth[39m[38;5;124m"[39m : [38;5;28mrange[39m([38;5;241m1[39m,[38;5;241m50[39m)},
[1;32m----> 2[0m Direct_est [38;5;241m=[39m [43mME_Single[49m[43m([49m[43msingle_dataset[49m[43m,[49m[43m [49m[43mr_model[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mOLS[39;49m[38;5;124;43m'[39;49m[43m,[49m
[0;32m      3[0m [43m                     [49m[43mproblearner_parameters[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[43mproblearner_parameters[49m[43m,[49m
[0;32m      4[0m [43m                     [49m[43mtruncate[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m50[39;49m[43m,[49m[43m [49m
[0;32m      5[0m [43m                     [49m[43mtarget_policy[49m[38;5;241;43m=[39;49m[43mtarget_policy[49m[43m,[49m[43m [49m[43mcontrol_policy[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[43mcontrol_policy[49m[43m,[49m[43m [49m
[0;32m      6[0m [43m                     [49m[43mdim_state[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m2[39;49m[43m,[49m[43m [49m[43mdim_mediator[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m1[39;49m[43m,[49m[43m [49m
[0;32m      7[0m [43m                     [49m[43mMCMC[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m50[39;49m[43m,[49m
[0;32m      8[0m [43m                     [49m[43mnature_decomp[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[0;32m      9[0m [43m                     [49m[43mseed[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m10[39;49m[43m,[49m
[0;32m     10[0m [43m                     [49m[43mmethod[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mDirect[39;49m[38;5;124;43m'[39;49m[43m)[49m
[0;32m     12[0m Direct_est[38;5;241m.[39mestimate_DE_ME()
[0;32m     13[0m Direct_est[38;5;241m.[39mest_DE, Direct_est[38;5;241m.[39mest_ME, Direct_est[38;5;241m.[39mest_TE,

File [1;32mD:\anaconda3\lib\site-packages\causaldm\learners\CEL\MA\ME_Single.py:64[0m, in [0;36mME_Single.__init__[1;34m(self, dataset, r_model, problearner_parameters, truncate, target_policy, control_policy, dim_state, dim_mediator, MCMC, seed, nature_decomp, method)[0m
[0;32m     60[0m [38;5;28mself[39m[38;5;241m.[39mrewardlearner[38;5;241m.[39mtrain()
[0;32m     62[0m [38;5;28mself[39m[38;5;241m.[39mpalearner [38;5;241m=[39m PALearner(dataset, problearner_parameters, seed, dim_state [38;5;241m=[39m dim_state,
[0;32m     63[0m                            dim_mediator [38;5;241m=[39m dim_mediator)
[1;32m---> 64[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mpalearner[49m[38;5;241;43m.[39;49m[43mtrain[49m[43m([49m[43m)[49m
[0;32m     66[0m [38;5;28mself[39m[38;5;241m.[39mpie_A [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mtarget_policy([38;5;28mself[39m[38;5;241m.[39mstate, [38;5;28mself[39m[38;5;241m.[39mdim_state, action [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39maction)
[0;32m     67[0m [38;5;28mself[39m[38;5;241m.[39mI_A [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mcontrol_policy([38;5;28mself[39m[38;5;241m.[39mstate, [38;5;28mself[39m[38;5;241m.[39mdim_state, [38;5;28mself[39m[38;5;241m.[39maction)

File [1;32mD:\anaconda3\lib\site-packages\causaldm\learners\CEL\MA\probLearner.py:182[0m, in [0;36mPALearner.train[1;34m(self)[0m
[0;32m    179[0m y [38;5;241m=[39m action
[0;32m    181[0m regressor [38;5;241m=[39m GridSearchCV(DecisionTreeClassifier(random_state[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mseed), [38;5;28mself[39m[38;5;241m.[39mparameters, n_jobs[38;5;241m=[39m[38;5;241m-[39m[38;5;241m1[39m)
[1;32m--> 182[0m [43mregressor[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m[43mX[49m[38;5;241;43m=[39;49m[43mX[49m[43m,[49m[43m [49m[43my[49m[38;5;241;43m=[39;49m[43my[49m[43m)[49m
[0;32m    183[0m best_params [38;5;241m=[39m regressor[38;5;241m.[39mbest_params_
[0;32m    184[0m [38;5;66;03m#print('action', best_params)[39;00m

File [1;32mD:\anaconda3\lib\site-packages\sklearn\model_selection\_search.py:926[0m, in [0;36mBaseSearchCV.fit[1;34m(self, X, y, groups, **fit_params)[0m
[0;32m    924[0m refit_start_time [38;5;241m=[39m time[38;5;241m.[39mtime()
[0;32m    925[0m [38;5;28;01mif[39;00m y [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m--> 926[0m     [38;5;28mself[39m[38;5;241m.[39mbest_estimator_[38;5;241m.[39mfit(X, y, [38;5;241m*[39m[38;5;241m*[39mfit_params)
[0;32m    927[0m [38;5;28;01melse[39;00m:
[0;32m    928[0m     [38;5;28mself[39m[38;5;241m.[39mbest_estimator_[38;5;241m.[39mfit(X, [38;5;241m*[39m[38;5;241m*[39mfit_params)

File [1;32mD:\anaconda3\lib\site-packages\sklearn\tree\_classes.py:937[0m, in [0;36mDecisionTreeClassifier.fit[1;34m(self, X, y, sample_weight, check_input, X_idx_sorted)[0m
[0;32m    899[0m [38;5;28;01mdef[39;00m [38;5;21mfit[39m(
[0;32m    900[0m     [38;5;28mself[39m, X, y, sample_weight[38;5;241m=[39m[38;5;28;01mNone[39;00m, check_input[38;5;241m=[39m[38;5;28;01mTrue[39;00m, X_idx_sorted[38;5;241m=[39m[38;5;124m"[39m[38;5;124mdeprecated[39m[38;5;124m"[39m
[0;32m    901[0m ):
[0;32m    902[0m [38;5;250m    [39m[38;5;124;03m"""Build a decision tree classifier from the training set (X, y).[39;00m
[0;32m    903[0m 
[0;32m    904[0m [38;5;124;03m    Parameters[39;00m
[1;32m   (...)[0m
[0;32m    934[0m [38;5;124;03m        Fitted estimator.[39;00m
[0;32m    935[0m [38;5;124;03m    """[39;00m
[1;32m--> 937[0m     [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m
[0;32m    938[0m [43m        [49m[43mX[49m[43m,[49m
[0;32m    939[0m [43m        [49m[43my[49m[43m,[49m
[0;32m    940[0m [43m        [49m[43msample_weight[49m[38;5;241;43m=[39;49m[43msample_weight[49m[43m,[49m
[0;32m    941[0m [43m        [49m[43mcheck_input[49m[38;5;241;43m=[39;49m[43mcheck_input[49m[43m,[49m
[0;32m    942[0m [43m        [49m[43mX_idx_sorted[49m[38;5;241;43m=[39;49m[43mX_idx_sorted[49m[43m,[49m
[0;32m    943[0m [43m    [49m[43m)[49m
[0;32m    944[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m

File [1;32mD:\anaconda3\lib\site-packages\sklearn\tree\_classes.py:203[0m, in [0;36mBaseDecisionTree.fit[1;34m(self, X, y, sample_weight, check_input, X_idx_sorted)[0m
[0;32m    200[0m [38;5;28mself[39m[38;5;241m.[39mn_outputs_ [38;5;241m=[39m y[38;5;241m.[39mshape[[38;5;241m1[39m]
[0;32m    202[0m [38;5;28;01mif[39;00m is_classification:
[1;32m--> 203[0m     [43mcheck_classification_targets[49m[43m([49m[43my[49m[43m)[49m
[0;32m    204[0m     y [38;5;241m=[39m np[38;5;241m.[39mcopy(y)
[0;32m    206[0m     [38;5;28mself[39m[38;5;241m.[39mclasses_ [38;5;241m=[39m []

File [1;32mD:\anaconda3\lib\site-packages\sklearn\utils\multiclass.py:197[0m, in [0;36mcheck_classification_targets[1;34m(y)[0m
[0;32m    189[0m y_type [38;5;241m=[39m type_of_target(y)
[0;32m    190[0m [38;5;28;01mif[39;00m y_type [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m [
[0;32m    191[0m     [38;5;124m"[39m[38;5;124mbinary[39m[38;5;124m"[39m,
[0;32m    192[0m     [38;5;124m"[39m[38;5;124mmulticlass[39m[38;5;124m"[39m,
[1;32m   (...)[0m
[0;32m    195[0m     [38;5;124m"[39m[38;5;124mmultilabel-sequences[39m[38;5;124m"[39m,
[0;32m    196[0m ]:
[1;32m--> 197[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124m"[39m[38;5;124mUnknown label type: [39m[38;5;132;01m%r[39;00m[38;5;124m"[39m [38;5;241m%[39m y_type)

[1;31mValueError[0m: Unknown label type: 'continuous'
ValueError: Unknown label type: 'continuous'

